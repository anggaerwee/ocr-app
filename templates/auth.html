<style>
.custom-shape-divider-bottom-1752462819 {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    overflow: hidden;
    line-height: 0;
    transform: rotate(180deg);
}

.custom-shape-divider-bottom-1752462819 svg {
    position: relative;
    display: block;
    width: calc(163% + 1.3px);
    height: 260px;
}

.custom-shape-divider-bottom-1752462819 .shape-fill {
    fill: #8BAEFB;
}

  .auth-card0 {
    box-shadow: 0px 4px 8px 0px #757575;
    border-radius: 0px;
  }

  .auth-card2 {
    margin: 0px 40px;
  }

  .auth-logo {
    background-repeat: no-repeat;
    background-size: contain;
    background-position: 0;
    width: 150px;
    height: 75px;
    margin-top: 20px;
    margin-left: 35px;
    background-image: url("data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20158.75%2052.917%22%20width=%22600%22%20height=%22200%22%3E%3Ctext%20style=%22font-size:35.9673px;line-height:1.25;font-family:sans-serif;letter-spacing:0;stroke-width:.897283%22%20x=%22-2.795%22%20y=%2224.584%22%20transform=%22scale(.6169%201.621)%22%3E%3Ctspan%20x=%22-2.795%22%20y=%2224.584%22%20style='font-style:italic;font-variant:normal;font-weight:700;font-stretch:normal;font-size:35.9673px;font-family:times%20new%20roman;-inkscape-font-specification:%22Times%20New%20Roman,%20Bold%20Italic%22;stroke-width:.897283'%3E%3Ctspan%20style='font-style:italic;font-variant:normal;font-weight:700;font-stretch:normal;font-size:35.9673px;font-family:times%20new%20roman;-inkscape-font-specification:%22Times%20New%20Roman,%20Bold%20Italic%22;fill:%231ba1e2;fill-opacity:1;stroke-width:.897283'%3EUniform%3C/tspan%3E%3Ctspan%20style='font-style:italic;font-variant:normal;font-weight:700;font-stretch:normal;font-size:35.9673px;font-family:times%20new%20roman;-inkscape-font-specification:%22Times%20New%20Roman,%20Bold%20Italic%22;fill:%23fc0;fill-opacity:1;stroke-width:.897283'%3ESoftware%3C/tspan%3E%3C/tspan%3E%3C/text%3E%3C/svg%3E");
  }
  .auth-image {
    width: 360px;
    height: 280px;
  }

  .auth-border-line {
    border-right: 1px solid #eeeeee;
  }

  .auth-google {
    background-color: #ffffff;
    color: #4285f4;
    font-size: 18px;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid #ddd;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .auth-google:hover {
    background-color: #f1f1f1;
    box-shadow: 0 0 8px rgba(0, 0, 0, 0.15);
  }

  .auth-line {
    height: 1px;
    width: 45%;
    background-color: #e0e0e0;
    margin-top: 10px;
  }

  .auth-or {
    width: 10%;
    font-weight: bold;
  }

  .text-sm {
    font-size: 14px !important;
  }

  ::placeholder {
    color: #bdbdbd;
    opacity: 1;
    font-weight: 300;
  }

  :-ms-input-placeholder {
    color: #bdbdbd;
    font-weight: 300;
  }

  ::-ms-input-placeholder {
    color: #bdbdbd;
    font-weight: 300;
  }

  input,
  textarea {
    padding: 10px 12px 10px 12px;
    border: 1px solid lightgrey;
    border-radius: 2px;
    margin-bottom: 5px;
    margin-top: 2px;
    width: 100%;
    box-sizing: border-box;
    color: #2c3e50;
    font-size: 14px;
    letter-spacing: 1px;
  }

  input:focus,
  textarea:focus {
    -moz-box-shadow: none !important;
    -webkit-box-shadow: none !important;
    box-shadow: none !important;
    border: 1px solid #304ffe;
    outline-width: 0;
  }

  button:focus {
    -moz-box-shadow: none !important;
    -webkit-box-shadow: none !important;
    box-shadow: none !important;
    outline-width: 0;
  }

  a {
    color: inherit;
    cursor: pointer;
  }

  .btn-blue {
    background-color: #1a237e;
    width: 150px;
    color: #fff;
    border-radius: 2px;
  }

  .btn-blue:hover {
    background-color: #000;
    cursor: pointer;
  }

  .bg-blue {
    color: #fff;
    background-color: #1a237e;
  }

  @media screen and (max-width: 991px) {
    .auth-logo {
      margin-left: 0px;
      background-image: url("data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20158.75%2052.917%22%20width=%22600%22%20height=%22200%22%3E%3Ctext%20style=%22font-size:35.9673px;line-height:1.25;font-family:sans-serif;letter-spacing:0;stroke-width:.897283%22%20x=%22-2.795%22%20y=%2224.584%22%20transform=%22scale(.6169%201.621)%22%3E%3Ctspan%20x=%22-2.795%22%20y=%2224.584%22%20style='font-style:italic;font-variant:normal;font-weight:700;font-stretch:normal;font-size:35.9673px;font-family:times%20new%20roman;-inkscape-font-specification:%22Times%20New%20Roman,%20Bold%20Italic%22;stroke-width:.897283'%3E%3Ctspan%20style='font-style:italic;font-variant:normal;font-weight:700;font-stretch:normal;font-size:35.9673px;font-family:times%20new%20roman;-inkscape-font-specification:%22Times%20New%20Roman,%20Bold%20Italic%22;fill:%231ba1e2;fill-opacity:1;stroke-width:.897283'%3EUniform%3C/tspan%3E%3Ctspan%20style='font-style:italic;font-variant:normal;font-weight:700;font-stretch:normal;font-size:35.9673px;font-family:times%20new%20roman;-inkscape-font-specification:%22Times%20New%20Roman,%20Bold%20Italic%22;fill:%23fc0;fill-opacity:1;stroke-width:.897283'%3ESoftware%3C/tspan%3E%3C/tspan%3E%3C/text%3E%3C/svg%3E");
    }

    .auth-image {
      width: 300px;
      height: 220px;
    }

    .auth-border-line {
      border-right: none;
    }

    .auth-card2 {
      border-top: 1px solid #eeeeee !important;
      margin: 0px 15px;
    }
  }
  .custom-alert {
    display: none;
    margin-top: 15px;
    padding: 12px 16px;
    border-radius: 6px;
    font-size: 15px;
    font-weight: 500;
    text-align: center;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: all 0.3s ease-in-out;
  }

  .custom-alert i {
    font-size: 20px;
    vertical-align: middle;
  }

  .custom-alert.success {
    background-color: #d4edda !important;
    color: #155724 !important;
    border: 1px solid #c3e6cb !important;
  }

  .custom-alert.danger {
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  }
  .custom-success {
    background-color: #d4edda !important;
    color: #155724 !important;
    border: 1px solid #c3e6cb !important;
  }
  #login-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }
</style>

<div class="custom-shape-divider-bottom-1752462819">
    <svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none">
        <path d="M0,0V46.29c47.79,22.2,103.59,32.17,158,28,70.36-5.37,136.33-33.31,206.8-37.5C438.64,32.43,512.34,53.67,583,72.05c69.27,18,138.3,24.88,209.4,13.08,36.15-6,69.85-17.84,104.45-29.34C989.49,25,1113-14.29,1200,52.47V0Z" opacity=".25" class="shape-fill"></path>
        <path d="M0,0V15.81C13,36.92,27.64,56.86,47.69,72.05,99.41,111.27,165,111,224.58,91.58c31.15-10.15,60.09-26.07,89.67-39.8,40.92-19,84.73-46,130.83-49.67,36.26-2.85,70.9,9.42,98.6,31.56,31.77,25.39,62.32,62,103.63,73,40.44,10.79,81.35-6.69,119.13-24.28s75.16-39,116.92-43.05c59.73-5.85,113.28,22.88,168.9,38.84,30.2,8.66,59,6.17,87.09-7.5,22.43-10.89,48-26.93,60.65-49.24V0Z" opacity=".5" class="shape-fill"></path>
        <path d="M0,0V5.63C149.93,59,314.09,71.32,475.83,42.57c43-7.64,84.23-20.12,127.61-26.46,59-8.63,112.48,12.24,165.56,35.4C827.93,77.22,886,95.24,951.2,90c86.53-7,172.46-45.71,248.8-84.81V0Z" class="shape-fill"></path>
    </svg>
</div>

<div class="flex flex-col items-center justify-center min-h-screen bg-gray-100">
  <div class="flex flex-wrap w-full max-w-5xl bg-white shadow-md rounded-xl overflow-hidden">
    
    <div class="w-full md:w-1/2 hidden md:block">
      <img src="{{ url_for('static', filename='login.svg' ) }}" alt="Login Image" class="w-full h-full object-cover">
    </div>
    
    <div class="w-full md:w-1/2 p-8">
      <h2 class="text-gray-900 text-2xl font-semibold mb-2 text-center">{{ title }} - <span class="text-indigo-600">{{ subtitle }}</span></h2>
      <p class="leading-relaxed mb-5 text-gray-600 text-center">Masukan user dan password untuk login</p>
      
      <div class="mb-4">
        <label for="email" class="block text-sm text-gray-600 mb-1">Username</label>
        <input type="email" id="user" name="email" class="form-control" placeholder="@username">
      </div>
      
      <div class="mb-6">
        <label for="password" class="block text-sm text-gray-600 mb-1">Password</label>
        <div class="input-group">
          <input type="password" id="pass" class="form-control" placeholder="xxx123"/>
              <span class="input-group-text" id="togglePassword" style="cursor: pointer">
                <i class="bi bi-eye-slash" id="eyeIcon"></i>
              </span>
            </div>
      </div>
      
      <button id="login-btn" type="submit" class="w-full bg-indigo-500 text-white mb-1 py-2 rounded-md hover:bg-indigo-600 transition duration-200">{{ subtitle }}</button>
      
      <p class="text-xs text-gray-500 my-3 text-center">Login dengan akun social media</p>
      <div class="container">
        <div class="row">
          <div class="col">
            <button onclick="google()" class="w-full bg-indigo-400 text-white py-2 rounded-md hover:bg-indigo-500 transition duration-200"><i class="bi bi-google me-1"></i> Google</button>
          </div>
          <div class="col">
            <button onclick="google()" class="w-full bg-indigo-400 text-white py-2 rounded-md hover:bg-indigo-500 transition duration-200"><i class="bi bi-facebook me-1"></i> Faceboook</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <p class="mt-3 font-semibold font-sans">Copyright Â© 2025 Yoma Solutions</p>
</div>

  <div id="alert-box" class="custom-alert">
    <i id="alert-icon" class="bx"></i>
    <span id="alert-msg"></span>
  </div>

  <script>
    $(document).ready(function () {
      $("#login-btn").on("click", function () {
        const username = $("#user").val().trim();
        const password = $("#pass").val().trim();

        if (!username && !password) {
          showAlert("Username dan password tidak boleh kosong!", "danger");
          return;
        }
        if (!username) {
          showAlert("Username tidak boleh kosong!", "danger");
          return;
        }
        if (!password) {
          showAlert("Password tidak boleh kosong!", "danger");
          return;
        }

        $("#login-btn").prop("disabled", true);

        $.ajax({
          type: "POST",
          url: "/api/login",
          contentType: "application/json",
          dataType: "json",
          data: JSON.stringify({ username, password }),
          xhrFields: {
            withCredentials: true,
          },
          success: function (data, textStatus, xhr) {
            console.log("status:", xhr.status);
            showAlert("Login berhasil!", "success", true);

            setTimeout(() => {
              window.location.href = "/dashboard";
            }, 1500);
          },
          error: function (xhr) {
            const msg =
              xhr.responseJSON?.msg || "Terjadi kesalahan saat login.";
            const status = xhr.status;
            let type = "danger";

            if (status === 401) {
              type = "danger";
            } else if (status >= 400 && status < 500) {
              type = "warning";
            } else if (status >= 500) {
              type = "danger";
            }

            showAlert(msg, type);
          },
          complete: function () {
            $("#login-btn").prop("disabled", false);
          },
        });
      });
      $("#togglePassword").on("click", function () {
        const passInput = $("#pass");
        const eyeIcon = $("#eyeIcon");
        const type =
          passInput.attr("type") === "password" ? "text" : "password";
        passInput.attr("type", type);
        eyeIcon.toggleClass("bi-eye bi-eye-slash");
      });
    });
    function showAlert(message, type = "danger") {
      const alertBox = $("#alert-box");
      const alertIcon = $("#alert-icon");
      const loginBtn = $("#login-btn");

      loginBtn.prop("disabled", true);

      alertBox
        .removeClass(
          "custom-alert custom-success custom-danger custom-warning custom-info"
        )
        .addClass(`custom-alert custom-${type}`);

      const iconClass = {
        success: "bx bx-check-circle",
        danger: "bx bx-error-circle",
        warning: "bx bx-error",
        info: "bx bx-info-circle",
      };
      alertIcon.removeClass().addClass(iconClass[type] || "bx bx-info-circle");

      $("#alert-msg").text(message);
      alertBox.fadeIn();

      setTimeout(() => {
        alertBox.fadeOut(() => {
          loginBtn.prop("disabled", false);
        });
      }, 1500);
    }

    function google() {
      Swal.fire({
        title: "Google Login",
        text: "Fitur ini belum tersedia.\nMohon Tunggu pembaruan selanjutnya.",
        icon: "info",
        confirmButtonText: "OK",
      });
    }
  </script>
</div>
